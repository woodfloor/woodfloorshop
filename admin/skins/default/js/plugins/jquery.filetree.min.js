function in_array(e,b,a){if(a){function d(g,f){return g===f}}else{function d(g,f){return g==f}}for(var c in b){if(d(b[c],e)){return true}}return false}function array_search(d,c,a){var a=!!a;for(var b in c){if((a&&c[b]===d)||(!a&&c[b]==d)){return true}}return false}if(jQuery){(function(a){var b="skins/"+a("#val_skin_folder").text()+"/images/";if(a("#val_admin_folder").length){b=a("#val_admin_folder").text()+"/"+b}else{if(a("#val_store_url").length){b=a("#val_store_url").text()+"/"+b}}if(a("#val_skin_common_images").length){b=b+a("#val_skin_common_images").text()+"/"}a.extend(a.fn,{fileTree:function(d,c){if(!d){var d={}}if(!c){var c=function(e){return}}if(!d.root){d.root="/"}if(!d.name){d.name="image"}if(!d.group){d.group=1}if(!d.script){d.script=a("#val_admin_file").text()}if(!d.unique){d.unique=(a(this).hasClass("unique"))?true:false}a(this).each(function(){function f(h,g){a(h).addClass("wait");a(".filetree.start").remove();if(a(h).children("ul").length>=1){a(h).removeClass("wait").children("ul").slideDown()}else{a.ajax({complete:function(i,j){a(".wait").removeClass("wait")},dataType:"json",global:false});a.getJSON(d.script,{_g:"xml",type:"files",q:"list",dir:g,group:d.group},function(j){a(h).find(".start").html("");var i=document.createElement("ul");a(i).addClass("filetree");a.each(j,function(p,r){var k=document.createElement("li");var m=document.createElement("a");switch(r.type){case"directory":a(k).addClass("directory collapsed");a(m).attr({href:"#",rel:r.path}).text(r.name);break;case"file":var q=document.createElement("span");var o=document.createElement("img");var l="0";if(typeof(file_default)!="number"){file_default=0}if(file_default==r.id){var n="2"}else{var n=(typeof(file_list)=="object"&&array_search(r.id,file_list))?1:0}a(q).addClass("actions");a(o).addClass("imgtoggle").data({id:d.name+"_"+r.id,rel:r.id,name:d.name+"["+r.id+"]",value:n});switch(n){case"2":l="star";break;default:l=n}o.src=b+l+".png";a(o).attr({rel:"#"+d.name+"_"+r.id}).addClass("checkbox");if(d.unique){a(o).addClass("unique")}a(q).append(o);a(k).append(q).addClass("file");a(m).attr({href:r.path+r.name,rel:r.path,title:r.description}).text(r.file);if(r.mime.match(/^image/)){a(k).addClass("image");a(m).bind("click",function(){a.fn.colorbox({href:a(m).attr("href"),open:true});return false})}break}a(k).append(m);a(i).append(k)});if(d.root==g){a(h).find("ul:hidden").show()}else{a(h).find("ul:hidden").slideDown("slow")}a(h).append(i).removeClass("wait");e(h)})}}function e(g){a(g).find("li>a").bind("click",function(){if(a(this).parent().hasClass("directory")){if(a(this).parent().hasClass("collapsed")){a(this).parent("ul").remove();f(a(this).parent(),a(this).attr("rel"));a(this).parent().removeClass("collapsed").addClass("expanded")}else{a(this).parent().find("ul").slideUp("slow");a(this).parent().removeClass("expanded").addClass("collapsed")}}return false})}a(this).html('<ul class="filetree start"><li class="wait">&nbsp;<li></ul>');f(a(this),escape(d.root))})}});a("input.toggle:hidden").each(function(){var c=(a(this).val()=="1")?"1":"0";var d=document.createElement("img");d.src=b+c+".png";if(c=="1"){d.alt=d.title="Disable"}else{d.alt=d.title="Enable"}a(d).addClass("checkbox");if(a(this).hasClass("unique")){a(d).addClass("unique")}a(d).attr("rel","#"+a(this).attr("id"));a(this).after(d)}).change(function(){switch(a(this).val()){case"1":var d="1";var e="Disable";break;case"2":var d="star";var e="";break;default:var d="0";var e="Enable";break}var c="img.checkbox[rel=#"+a(this).attr("id")+"]";a(c).attr({src:b+d+".png",alt:e,title:e})});a("#content_body").on("click","img.imgtoggle",function(){var d=a(this).data("id");var g=a(this).hasClass("unique");var e=document.createElement("input");var c="0";if(g){a(e).addClass("unique")}a(e).addClass("toggle").attr({type:"hidden",id:d,rel:a(this).data("rel"),name:a(this).data("name"),value:a(this).data("value")}).change(function(){switch(a(this).val()){case"1":c="1";break;case"2":c="star";if(a("#master_image_preview").exists()){var i=a(this).closest(".image").find("a").attr("href");a("#master_image_preview").attr("src",i)}break;default:c="0";break}var h="img.checkbox[rel=#"+d+"]";a(h).attr({src:b+c+".png"})});var f=a(this).parent("span.action");a(this).before(e);a(this).removeClass("imgtoggle").addClass("toggle")});a("#content_body").on("click","img.checkbox",function(){var e=a(this).attr("rel");var c=a(this).parents("div:first").hasClass("fm-filelist");var f=a(this).hasClass("unique");switch(a(e).val()){case"1":if(f||!c){var d="0"}else{a("input[value=2].toggle").each(function(){a("img[rel="+a(this).attr("rel")+"].checkbox").val("1").change()});var d="2"}break;case"2":var d="0";break;default:if(f){a(".fm-container input.toggle").val("0").change()}var d="1";break}a(e).val(d).change()})})(jQuery)};