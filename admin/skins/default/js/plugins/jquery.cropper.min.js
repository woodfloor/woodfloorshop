jQuery.fn.cropper=function(){this.each(function(){var g=new Image();var c=jQuery(this).attr("id");g.src=jQuery(this).attr("src");var b=document.createElement("div");jQuery(b).addClass("crop_wrapper").css({width:g.width,height:g.height});var e=document.createElement("input");jQuery(e).attr({id:c+"_x",name:c+"[x]",type:"hidden"});jQuery(b).append(e);var d=document.createElement("input");jQuery(d).attr({id:c+"_y",name:c+"[y]",type:"hidden"});jQuery(b).append(d);var i=document.createElement("input");jQuery(i).attr({id:c+"_h",name:c+"[h]",type:"hidden"});jQuery(b).append(i);var f=document.createElement("input");jQuery(f).attr({id:c+"_w",name:c+"[w]",type:"hidden"});jQuery(b).append(f);var a=document.createElement("div");jQuery(a).addClass("crop_source").css({width:g.width,height:g.height,background:"transparent url("+g.src+") no-repeat scroll 0%",opacity:0.3});var h=document.createElement("div");jQuery(h).addClass("crop_select").resizable({containment:"parent",handles:"all",knobHandles:true,ghost:false,autoHide:false,minWidth:75,minHeight:75,resize:function(l,k){var j=jQuery(this).data("resizable");this.style.backgroundPosition="-"+(j.position.left)+"px -"+(j.position.top)+"px";jQuery(e).val(j.position.left);jQuery(d).val(j.position.top);jQuery(i).val(j.size.height);jQuery(f).val(j.size.width)},stop:function(l,k){var j=jQuery(this).data("resizable");this.style.backgroundPosition="-"+(j.position.left)+"px -"+(j.position.top)+"px"}}).draggable({cursor:"move",containment:"parent",drag:function(k,j){var l=jQuery(this).data("draggable");jQuery(e).val(l.position.left);jQuery(d).val(l.position.top);this.style.backgroundPosition="-"+(l.position.left)+"px -"+(l.position.top)+"px"}}).css({background:"transparent url("+g.src+") no-repeat scroll 0px 0px"});jQuery(b).append(a);jQuery(b).append(h);jQuery(this).replaceWith(b)})};jQuery(document).ready(function(){jQuery("img.cropper").cropper()});